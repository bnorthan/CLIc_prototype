name: Release Notification

on:
    release:
      types: [published]
    workflow_dispatch:  # This allows manual triggering

jobs:
  release-notification:
    runs-on: ubuntu-latest
    steps:

      - name: Fetch latest release tag
        run: |
          latest_release=$(curl -s https://api.github.com/repos/${{ github.repository }}/releases/latest | jq -r .tag_name)
          echo "LATEST_RELEASE_TAG=$latest_release" >> $GITHUB_ENV

      - name: Send dispatch to bot_playground
        uses: peter-evans/repository-dispatch@v3
        with:
          token: ${{ secrets.TOKEN_SR }}
          repository: clEsperanto/bot_playground
          event-type: clic_update
          client-payload: '{"release_tag": "${{ env.LATEST_RELEASE_TAG }}"}' 

            
